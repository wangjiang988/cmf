var ZC=ZC||{};ZC.pc={},ZC.pc.Version="2.0.1",ZC.pc.FileName="pc.min.js",ZC.pc.namespace=function(e){var i=ZC,t="ZC",n=e.split("."),a=n.length;t===n[0]&&(n.shift(),a--);for(var o=0,c="";a>o;o++)c=n[o],"undefined"==typeof i[c]&&(i[c]={}),i=i[c];return i},ZC.pc.namespace("ZC.pc.config"),ZC.pc.config={targetList:{zhichiBtnBox:"#zhichiBtnBox",zhichiBtn:"#zhichiBtn",zhichiBtnText:"#zhichiBtnText",zhichiCount:"#zhichiCount",zhichiIframeBox:"#zhichiIframeBox",zhichiIframe:"#zhichiIframe"},paramNameList:["sysNum","source","tel","uname","partnerId","email","iframe","evn"],scriptParamList:{},urlList:{robotLoadAction:"/chat/user/load.action",robotVisitAction:"/chat/user/visit.action",robotQueryVisitAction:"/chat/user/queryVisit.action"},pageNow:1,pageSize:15},ZC.pc.namespace("ZC.pc.cacheFlag"),ZC.pc.cacheFlag={isShowedIframe:!1,isCreatedIframe:!1,isReinit:!1,isEnableVisit:!1},ZC.pc.namespace("ZC.pc.cacheInfo"),ZC.pc.cacheInfo={targetObjList:{},targetStrList:{},customConfig:{},host:{name:"",urlList:{}},periodTask:{queryVist:null},aid:"",visitId:""},ZC.pc.init=function(){var e=ZC.pc;e.cacheInfo.urlParamList=e.common.getUrlParam(),e.cacheInfo.scriptParamList=e.common.getScriptParam(),e.cacheInfo.host.name=e.common.host.getHost(),e.cacheInfo.host.urlList=e.common.host.getUrlList(),e.loadInit()},ZC.pc.loadInit=function(){var e=ZC.pc,i=e.cacheInfo.jsDom,t="",n=function(i){e.cacheFlag.isCreatedIframe||(e.iframe.createIframeBox(),e.cacheFlag.isCreatedIframe=!0,e.updateTargetObjList()),e.cacheFlag.isReinit&&window.frames[e.cacheInfo.targetStrList.zhichiIframe].postMessage("zhichiReinit","*"),e.pin.effectManip(!1,0),e.iframe.effectManip(!0)};e.common.ajax.postAction({isDealUrl:!0,url:"robotLoadAction",id:"zhichiJsonp",paramList:{sysNum:e.cacheInfo.urlParamList.sysNum,source:e.cacheInfo.urlParamList.source||0}},function(a){if(e.common.extend(e.cacheInfo.customConfig,a),i&&i.className){t=e.common.dom.find("."+i.className);for(var o in t){var c=t[o];"SCRIPT"!==c.tagName&&e.common.event.bindTargetEvent(c,"click",function(i){e.cacheFlag.isShowedIframe?e.iframe.effectManip(!1):n(i),e.common.setCookie("s",1)})}}else e.pin.createPin(),e.common.event.bindTargetEvent(e.cacheInfo.targetObjList.zhichiBtn,"click",function(i){n(i),e.common.setCookie("s",1),e.cacheInfo.targetObjList.zhichiCount.style.display="none"});return"1"==e.common.getCookie("s")?void n():void(e.cacheFlag.isCreatedIframe||0!==e.cacheInfo.customConfig.isInvite||setTimeout(function(){e.cacheFlag.isCreatedIframe||e.common.ajax.postAction({isDealUrl:!0,url:"robotVisitAction",id:"zhichiVisit",paramList:{sysNum:e.cacheInfo.urlParamList.sysNum,source:e.cacheInfo.urlParamList.source||0,title:document.title,uid:a.uid}},function(i){if(i&&i.visitId){var t=i.visitId,a=1e4,o=3e5;timeCount=1,timeFunc=function(){e.cacheInfo.periodTask.queryVist=setInterval(function(){return timeCount*a>o?void clearInterval(e.cacheInfo.periodTask.queryVist):void(e.cacheFlag.isCreatedIframe||(timeCount++,e.common.ajax.postAction({isDealUrl:!0,url:"robotQueryVisitAction",id:"zhichiQueryVisit",paramList:{visitId:t}},function(i){i&&i.type&&i.aid&&207===i.type&&(e.cacheFlag.isEnableVisit=!0,e.cacheInfo.aid=i.aid,e.cacheInfo.visitId=t,n(),e.common.setCookie("s",1),clearInterval(e.cacheInfo.periodTask.queryVist))})))},a)},timeFunc()}})},1e3))})},ZC.pc.updateTargetStrList=function(){var e=ZC.pc,i={};for(var t in e.config.targetList)i[t]=e.config.targetList[t].split("#")[1];return e.common.extend(e.cacheInfo.targetStrList,i,!0)},ZC.pc.updateTargetObjList=function(){var e=ZC.pc;e.common.extend(e.cacheInfo.targetObjList,e.common.dom.getTargetObjList(e.config.targetList),!0)},ZC.pc.cssEffectManip=function(e,i,t,n){var e=(ZC.pc,"object"==typeof e?e:null),i="object"==typeof i?i:null,a="",n=n||500;e&&i&&i.effectIn&&i.effectOut&&(a=t?i.effectIn:i.effectOut,setTimeout(function(){for(var i in a)e.style[i]=a[i]},n))},ZC.pc.namespace("ZC.pc.common"),ZC.pc.common.formatLan=function(e,i){var t=ZC.pc,n=/\{(\d+)\}/g;return n.test(e)&&i&&t.common.isArray(i)?e.replace(n,function(e,t){return i[t]}):e},ZC.pc.namespace("ZC.pc.common.host"),ZC.pc.common.host.getHost=function(){var e=ZC.pc,i=window.location.protocol;return i+(e.cacheInfo.urlParamList.evn?"//test.sobot.com":"//new.sobot.com")},ZC.pc.common.host.getUrlList=function(){var e=ZC.pc,i=e.cacheInfo.host.name,t=e.cacheInfo.urlParamList,n=[],a="",o=[],c="";if("object"==typeof t)for(var r in t)null!=t[r]&&("from"!==r&&n.push(r+"="+t[r]),o.push(r+"="+t[r]));return n&&n.length&&(a=n.join("&")),a.length&&(a="?"+a),o.push("from=iframe"),o&&o.length&&(c=o.join("&")),c.length&&(c="?"+c),{pc:i+"/chat/pc/index.html"+a+"&r="+Math.random(),pcIframe:i+"/chat/pc/index.html"+c+"&r="+Math.random()}},ZC.pc.namespace("ZC.pc.common.ajax"),ZC.pc.namespace("ZC.pc.common.ajax.urlList"),ZC.pc.common.ajax.urlList=ZC.pc.config.urlList,ZC.pc.common.ajax.dealUrl=function(e){var i=ZC.pc,t=i.common.ajax.urlList||i.config.urlList,n={host:e.host||i.cacheInfo.host.name,actionName:t[e.actionName]||"",paramList:e.paramList||null},a=[],o="",c="";if("object"==typeof e.paramList)for(var r in e.paramList)a.push(r+"="+e.paramList[r]);return a&&a.length&&(o=a.join("&")),c=n.host+n.actionName+"?"+o},ZC.pc.common.ajax.postAction=function(e,i){var t=ZC.pc,n=document.createElement("script"),a=e.isDealUrl?t.common.ajax.dealUrl({actionName:e.url,paramList:e.paramList}):e.url?e.url:"",o="getback"+(new Date).getTime();a=a+"&callback="+o,n.id=e.id,n.setAttribute("src",a),document.body.appendChild(n),window[o]=function(e){document.body.removeChild(n),i&&i(e)}},ZC.pc.common.getUrlParam=function(e,i,t){var n=ZC.pc,e="string"==typeof e?e:window.location.search,a=[],t=void 0===t?0:t,o=e.substr(1),c=function(e,i){for(var t="",n="",a="",c=0===i?"":{},r="",s=0,p=e.length;p>s;s++)t=e[s],n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),a=o.match(n),r=null!=a?decodeURI(decodeURI(a[2])):null,0===i?c=r:c[t]=r;return c};return i&&!n.common.isArray(i)?(a=[i],t=0):i&&n.common.isArray(i)?(a=i,t=1):(a=n.config.paramNameList,t=1),c(a,t)},ZC.pc.common.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},ZC.pc.common.getScriptParam=function(){var e,i,t=ZC.pc,n=t.common.dom.find("#zhichiload"),a=0,o=null,c=[],r=0,s={};if(n=n?[n]:document.scripts,a=n.length,n&&a){for(var p=0,m="";a>p;p++)if(m=n[p],m.src.indexOf(t.FileName)>-1){t.cacheInfo.jsDom=m,o=m.src.substring(m.src.lastIndexOf("/")+1,m.src.length);break}if(o&&o.length){e=o.indexOf("?"),i=o.substring(e+1,o.length),c=i.split("&"),r=c.length;for(var f,l,p=0,m="";r>p;p++)m=c[p].split("="),f=m[0],l=m[1],s[f]=l}for(var f in s)t.cacheInfo.urlParamList[f]||(t.cacheInfo.urlParamList[f]=s[f]);return s}},ZC.pc.common.extend=function(e,i,t){if(e&&"object"==typeof e&&i&&"object"==typeof i){for(var n in i)!i.hasOwnProperty(n)||e.hasOwnProperty(n)&&!t||(e[n]=i[n]);return e}},ZC.pc.namespace("ZC.pc.common.dom"),ZC.pc.common.dom.find=function(e,i){var t="",n=[],a="*",o=[],c="";if(i=i||document,-1<e.indexOf("#"))e=e.replace("#",""),t=i.getElementById(e);else if(-1<e.indexOf(".")){0!==e.indexOf(".")?(o=e.split("."),a=o[0],e=o[1]):e=e.replace(".",""),c=i.getElementsByTagName(a);for(var r=0,s=c.length,p="",m=0;s>r;r++){p=c[r].className.split(" "),m=p.length;for(var f=0;m>f;f++)if(p[f]==e){n.push(c[r]);break}}t=n}else t=i.getElementsByTagName(e);return t},ZC.pc.common.dom.getTargetObjList=function(e,i){var t=ZC.pc,i=i&&"object"==typeof i?i:window,e=e?e:t.config.targetList,n={};for(var a in e)n[a]=t.common.dom.find(e[a],i.document);return n},ZC.pc.common.dom.append=function(e,i){var i=(ZC.pc,i||document.body),t=(i.innerHTML,document.createDocumentFragment()),n=t.appendChild(document.createElement("div"));n.innerHTML=e,n=t.lastChild,t.removeChild(n),i.appendChild(n.childNodes[0])},ZC.pc.namespace("ZC.pc.common.event"),ZC.pc.common.event.bindTargetEvent=function(e,i,t,n){var a=ZC;if("object"!=typeof e&&(e=a.common.dom.find(e)),t&&"function"==typeof t){var n=t;window.addEventListener?e.addEventListener(i,n,!1):window.attachEvent&&e.attachEvent("on"+i,n)}},ZC.pc.common.event.stopEvent=function(e){e&&e.preventDefault?e.preventDefault():window.event.returnValue=!1},ZC.pc.common.setCookie=function(e,i,t){var n=ZC.pc,e=n.cacheInfo.urlParamList.sysNum+"_"+e,a=new Date,o="";a.setTime(a.getTime()+864e5),o=a.toGMTString(),document.cookie=e+"="+i+";expires="+o},ZC.pc.common.getCookie=function(e){for(var i=ZC.pc,e=i.cacheInfo.urlParamList.sysNum+"_"+e,t=document.cookie,n=t.split("; "),a=n.length,o=0,c="",r=[];a>o;o++)if(c=n[o],r=c.split("="),e===r[0])return r[1];return!1},ZC.pc.namespace("ZC.pc.pin"),ZC.pc.namespace("ZC.pc.pin.classLan"),ZC.pc.pin.classLan={transition_base:"-moz-transition: all .3s ease-in-out .1s; -webkit-transition: all .3s ease-in-out .1s; -o-transition: all .3s ease-in-out .1s; -ms-transition: all .3s ease-in-out .1s; transition: all .3s ease-in-out .1s;",pin_base:"position: fixed; z-index: 2147483583; box-sizing: content-box; {0} {1}",pin_base_12:"height: 43px; bottom: -43px; padding: 0 20px; border-radius: 4px 4px 0 0; {0}",pin_effect_in_12:{bottom:0},pin_effect_out_12:{bottom:"-43px"},pin_base_34:"top: 50%; margin-top: -104px; width: 40px; {0}",pin_a_base:"text-decoration: none; outline: none; font-family: Microsoft Yahei, Arial, Helvetica; color: #fff; font-size: 16px; display: inline-block; margin: 0; padding: 0; border: none; {0}",pin_a_base_12:"line-height:43px; float:none;",pin_a_base_34:"height: 100%; width: 100%;",pin_img_base:"vertical-align: middle; width: 31px; border:none; {0}",pin_img_base_12:"margin: -4px 10px 0 0; float: none; position: static; height: 27px;",pin_img_base_34:"margin: 15px 0px 15px 4px;",pin_span_base:"font-family: Microsoft Yahei, Arial, Helvetica; color: #fff; font-size:16px; margin: 0; padding: 0; {0}",pin_span_base_12:"",pin_span_base_34:"margin-left: 10px; margin-bottom: 20px; display: inline-block; width: 1em; word-break: break-all; white-space: pre-wrap;",pin_count_base:"height: 30px; width: 30px; line-height: 30px; border: 1px solid #FFFFFF; border-radius: 50%; background-color: red; color: #FFFFFF; text-align: center; display: none; position: absolute; {0}",pin_count_base_1:"right: -15px; top: -15px;",pin_count_base_2:"right: -15px; top: -15px",pin_count_base_3:"bottom: -15px; right: -15px;",pin_count_base_4:"bottom: -15px; left: -15px;",iframeBox_base:"width: 320px; height: 480px; position: fixed; bottom: -500px; border-radius: 5px 5px 0 0; overflow: hidden; z-index: 2147483583; box-shadow: rgba(0,0,0,0.1) 0px 0px 5px 2px; {0} {1}"},ZC.pc.pin.createPin=function(){var e=ZC.pc,i={},t=e.cacheInfo.customConfig,n="",a="";e.pin.pinStyle=a=e.pin.getPinStyle(),i=e.updateTargetStrList(),n='<div id="'+i.zhichiBtnBox+'" style="'+a.pin+'"><a hideFocus id="'+i.zhichiBtn+'" href="javascript: void(0);" style="'+a.pin_a+'"><img style="'+a.pin_img+'" src="'+e.cacheInfo.host.name+'/chat/pc/img/zhichichatBtnBg.png"><span style="'+a.pin_span+'">'+t.title+'</span></a><span id="'+i.zhichiCount+'" style="'+a.pin_count+'"></span></div>',e.common.dom.append(n),e.updateTargetObjList(),e.pin.effectManip(!0)},ZC.pc.pin.getPinStyle=function(){var e=ZC.pc,i=e.pin.classLan,t=e.cacheInfo.customConfig,n="",a="",o="",c="",r="",s="",p="",m="",f="",l="",h="",u="",d="";switch(t.margin){case 1:n="border-radius: 4px 4px 0px 0px; right: 100px; background: "+t.color+";",a=i.pin_base_12,c=i.pin_a_base_12,s=i.pin_img_base_12,m=i.pin_span_base_12,l=i.pin_count_base_1,u=i.pin_effect_in_12,d=i.pin_effect_out_12;break;case 2:n="border-radius: 4px 4px 0px 0px; left: 50px; background: "+t.color+";",a=i.pin_base_12,c=i.pin_a_base_12,s=i.pin_img_base_12,m=i.pin_span_base_12,l=i.pin_count_base_2,u=i.pin_effect_in_12,d=i.pin_effect_out_12;break;case 3:n="border-radius: 0px 5px 5px 0px; left: -40px; background: "+t.color+";",a=i.pin_base_34,c=i.pin_a_base_34,s=i.pin_img_base_34,m=i.pin_span_base_34,l=i.pin_count_base_3,u={left:0},d={left:"-40px"};break;case 4:n="border-radius: 5px 0px 0px 5px; right: -40px; background: "+t.color+";",a=i.pin_base_34,c=i.pin_a_base_34,s=i.pin_img_base_34,m=i.pin_span_base_34,l=i.pin_count_base_4,u={right:0},d={right:"-40px"}}return o=e.common.formatLan(i.pin_base,[e.common.formatLan(a,[n]),i.transition_base]),r=e.common.formatLan(i.pin_a_base,[c]),p=e.common.formatLan(i.pin_img_base,[s]),f=e.common.formatLan(i.pin_span_base,[m]),h=e.common.formatLan(i.pin_count_base,[l]),{pin:o,pin_a:r,pin_img:p,pin_span:f,pin_count:h,effectIn:u,effectOut:d}},ZC.pc.pin.effectManip=function(e,i){var t=ZC.pc,n=t.cacheInfo.targetObjList.zhichiBtnBox,a=t.pin.pinStyle,i=i||500;t.cssEffectManip(n,a,e,i)},ZC.pc.namespace("ZC.pc.iframe"),ZC.pc.iframe.createIframeBox=function(){var e=ZC.pc,i={},t="",n="",a=e.cacheInfo.host.urlList.pcIframe;e.iframe.iframeBoxStyle=n=e.iframe.getIframeBoxStyle(),i=e.updateTargetStrList(),e.cacheFlag.isEnableVisit&&e.cacheInfo.aid&&e.cacheInfo.visitId&&(a=a+"#aid="+e.cacheInfo.aid+"#visitId="+e.cacheInfo.visitId),t='<div id="'+i.zhichiIframeBox+'" style="'+n.iframeBox+'"><iframe id="'+i.zhichiIframe+'" src="'+a+'" name="'+i.zhichiIframe+'" frameborder="no" scrolling="no" style="width: 100%; height: 100%; border: 0;"></iframe></div>',e.common.dom.append(t),e.common.event.bindTargetEvent(window,"message",function(i){var t,n=i.data;e.common.dom.getTargetObjList();e.cacheFlag.isReinit=!0,/^unreadCount\-\d+$/.test(n)?(e.cacheFlag.isReinit=!1,t=n.split("-")[1]>99?"99+":n.split("-")[1]):"zhichiMin"==n?(e.cacheFlag.isReinit=!1,e.common.setCookie("s",0)):"zhichiClose"==n&&e.common.setCookie("s",0),e.pin.effectManip(!0),e.iframe.effectManip(!1,0),e.common.event.stopEvent(i)})},ZC.pc.iframe.getIframeBoxStyle=function(){var e=ZC.pc,i=e.cacheInfo.customConfig,t=e.pin.classLan,n="",a=t.iframeBox_base,o="";switch(i.margin){case 1:n="right: 50px;";break;case 2:n="left: 50px;";break;case 3:n="left: 50px;";break;case 4:n="right: 50px;"}return o=e.common.formatLan(a,[n,t.transition_base]),{iframeBox:o,effectIn:{bottom:0},effectOut:{bottom:"-500px"}}},ZC.pc.iframe.effectManip=function(e,i){var t=ZC.pc,n=t.cacheInfo.targetObjList.zhichiIframeBox,a=t.iframe.iframeBoxStyle,i=i||500;t.cssEffectManip(n,a,e,i),t.cacheFlag.isShowedIframe=e},document.onready=function(){ZC.pc.init()}();